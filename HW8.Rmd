---
title: ''
output:
  html_document:
    toc: true
    toc_float: true
    toc_depth: 3
  pdf_document:
    toc: true
    toc_depth: '3'
---

### Name: Richard Lam
### EID: rwl734
### GitHub Repo: https://github.com/RichardLam27/SDS315.git
\
\
\

```{r global_options, include = FALSE}

#importing libraries, datasets, and global code options

knitr::opts_chunk$set(echo = FALSE,
                      eval = TRUE, 
                      warning = FALSE, 
                      message = FALSE
                      )
library(tidyverse)
library(lubridate)
library(knitr)
library(rvest)
library(mosaic)
library(boot)


  
```

## Question 1 
### Part A
```{r}
# Load data
data <- read.csv("creatinine.csv")

# Fit linear regression model
model <- lm(creatclear ~ age, data = data)

# Show model summary
summary(model)

```
To get the clearance rate for a 55 year old, we used the linear regression equation B_0 + B_1 * age. So we plug in the variables from the model and 55 for age to get 147.81−0.62×55=113.71. 

\

### Part B 
```{r}
summary(model)$coefficients
```
The slope of the regression line tells us the clearance rate decreases by 0.62 mL/min per year.

\

### Part C
```{r}
# Predicted values
pred_40 <- predict(model, newdata = data.frame(age = 40))
pred_60 <- predict(model, newdata = data.frame(age = 60))

# Residuals (actual - predicted)
residual_40 <- 135 - pred_40
residual_60 <- 112 - pred_60

residual_40
residual_60

cat("40-year-old residual (actual - predicted):", residual_40, "\n")
cat("60-year-old residual (actual - predicted):", residual_60, "\n")

if (residual_40 > residual_60) {
  cat("The 40-year-old is healthier for their age.\n")
} else {
  cat("The 60-year-old is healthier for their age.\n")
}
```
## Question 2 
### Part 1

```{r}
covid <- read.csv("covid.csv")

italy <- covid |> 
  filter(country == "Italy")
italy_model <- lm(log(deaths) ~ days_since_first_death, data = italy)
r_italy <- coef(italy_model)[2]
doubling_italy <- log(2) / r_italy

set.seed(42)
boot_italy <- boot(data = italy, statistic = function(data, i) {
  sample_data <- data[i, ]
  coef(lm(log(deaths) ~ days_since_first_death, data = sample_data))[2]
}, R = 1000)
ci_r_italy <- boot.ci(boot_italy, type = "perc")$percent[4:5]
ci_doubling_italy <- log(2) / rev(ci_r_italy)


```

Estimated growth rate (r): 0.211

95% Confidence Interval for growth rate: [0.196, 0.227]

Estimated doubling time: 3.3 days

95% Confidence Interval for doubling time: [3.1, 3.5] days

\

### Part 2
```{r}

```



